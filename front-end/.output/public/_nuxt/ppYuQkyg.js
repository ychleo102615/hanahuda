import{d as L,a2 as R,r as y,k as o,J as z,o as V,F as j,y as d,A as t,C as v,a3 as x,V as m,K as A,B as h,R as G,T as w,q as N,z as c,_ as D}from"./BKahYXLk.js";import{u as H,a as O,A as K,T as U}from"./CNdY3Ly9.js";const q={class:"min-h-screen bg-green-900 flex flex-col"},J={class:"h-14 shrink-0"},Q={class:"flex-1 flex items-center justify-center p-4"},W={class:"max-w-4xl w-full"},Y={class:"border-2 border-gray-700/50 rounded-xl p-6 bg-gray-900/20"},X={class:"grid gap-6 md:grid-cols-2"},Z={class:"md:col-span-2 bg-gray-800/80 backdrop-blur-sm rounded-lg shadow-xl p-6 border border-gray-700 min-h-[380px] grid grid-rows-[auto_1fr_auto]"},$={class:"flex items-center justify-center py-6"},tt={class:"w-full space-y-6"},et={key:0,class:"space-y-6"},at=["disabled"],st={key:1,class:"space-y-6"},ot={"data-testid":"finding-indicator",class:"text-center"},rt={key:2,class:"space-y-6"},nt={"data-testid":"error-message",role:"alert",class:"bg-red-900/30 border border-red-700 rounded-lg p-4"},lt={class:"flex items-start"},it={class:"flex-1"},dt={class:"mt-1 text-sm text-red-400"},ct=L({__name:"lobby",setup(mt){const a=R(),k=H(w.StartGamePort),u=sessionStorage.getItem("gameMode")||"mock",g=u==="mock"?O(w.MockEventEmitter):null,l=y(!1),r=y(30);let i=null;const _=o(()=>a.status==="idle"),M=o(()=>a.status==="finding"),C=o(()=>a.status==="error"),b=o(()=>a.canStartMatchmaking),S=o(()=>r.value<10),B=o(()=>[{id:"back-home",label:"Back to Home",icon:"ðŸ ",onClick:F}]),E=()=>{l.value=!l.value},p=()=>{l.value=!1},F=()=>{N("/"),p()},T=async()=>{if(b.value)try{a.setStatus("finding"),f(),await k.execute(),console.info("[GameLobby] éŠæˆ²å•Ÿå‹•æˆåŠŸ"),u==="mock"&&g&&(console.info("[GameLobby] å•Ÿå‹• Mock äº‹ä»¶è…³æœ¬"),g.start())}catch(s){console.error("[GameLobby] éŠæˆ²å•Ÿå‹•å¤±æ•—:",s),n(),a.setStatus("error"),a.setErrorMessage(s instanceof Error?s.message:"Failed to join matchmaking. Please try again.")}},P=()=>{a.clearSession()},f=()=>{r.value=30,n(),i=window.setInterval(()=>{r.value-=1,r.value<=0&&(n(),I())},1e3)},n=()=>{i!==null&&(clearInterval(i),i=null)},I=()=>{a.setStatus("error"),a.setErrorMessage("Matchmaking timeout. Please try again.")};return z(()=>a.status,s=>{s!=="finding"&&n()}),V(()=>{a.status==="finding"&&f()}),j(()=>{n()}),(s,e)=>(c(),d("div",q,[t("header",J,[v(U,{variant:"lobby",onMenuClick:E})]),t("main",Q,[t("div",W,[t("div",Y,[t("div",X,[t("div",Z,[e[7]||(e[7]=t("h2",{class:"text-xl font-bold text-white pb-4 border-b border-gray-600"}," Quick Match ",-1)),t("div",$,[t("div",tt,[_.value?(c(),d("div",et,[e[0]||(e[0]=t("p",{class:"text-center text-gray-300"}," Ready to play? Click below to find a match! ",-1)),t("button",{"data-testid":"find-match-button","aria-label":"Find a match to play",class:"w-full bg-primary-600 hover:bg-primary-500 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!b.value,onClick:T}," Find Match ",8,at)])):m("",!0),M.value?(c(),d("div",st,[t("div",ot,[e[1]||(e[1]=x('<div class="flex items-center justify-center space-x-2 mb-4" data-v-7d1f5605><svg class="animate-spin h-6 w-6 text-primary-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-7d1f5605><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-7d1f5605></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-7d1f5605></path></svg><span class="text-lg font-medium text-white" data-v-7d1f5605>Finding Match...</span></div>',1)),t("div",{"data-testid":"matchmaking-countdown","aria-live":"polite",class:A(["text-4xl font-bold tabular-nums",S.value?"text-red-500 warning":"text-primary-400"])},h(r.value),3),e[2]||(e[2]=t("p",{class:"text-sm text-gray-400 mt-2"},"seconds remaining",-1))]),e[3]||(e[3]=t("button",{"data-testid":"find-match-button",class:"w-full bg-gray-600 text-gray-400 font-semibold py-3 px-6 rounded-lg cursor-not-allowed opacity-50",disabled:""}," Finding Match... ",-1))])):m("",!0),C.value?(c(),d("div",rt,[t("div",nt,[t("div",lt,[e[5]||(e[5]=t("svg",{class:"h-5 w-5 text-red-400 mt-0.5 mr-3 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("div",it,[e[4]||(e[4]=t("h3",{class:"text-sm font-medium text-red-300"},"Matchmaking Failed",-1)),t("p",dt,h(G(a).errorMessage||"An error occurred. Please try again."),1)])])]),t("button",{"data-testid":"retry-button","aria-label":"Retry matchmaking",class:"w-full bg-primary-600 hover:bg-primary-500 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200",onClick:P}," Retry "),e[6]||(e[6]=t("button",{"data-testid":"find-match-button",class:"w-full bg-gray-600 text-gray-400 font-semibold py-3 px-6 rounded-lg cursor-not-allowed opacity-50",disabled:""}," Find Match ",-1))])):m("",!0)])]),e[8]||(e[8]=t("div",{class:"pt-6 border-t border-gray-600"},[t("p",{class:"text-sm text-gray-400 text-center"}," You will be matched with an opponent and the game will start automatically. ")],-1))]),e[9]||(e[9]=x('<div class="relative bg-gray-800/40 backdrop-blur-sm rounded-lg shadow-xl p-6 border border-gray-700/50 opacity-60" data-v-7d1f5605><div class="absolute top-4 right-4 bg-primary-600/80 text-white text-xs font-bold px-3 py-1 rounded-full" data-v-7d1f5605> Coming Soon </div><h2 class="text-xl font-bold text-gray-400 mb-6 pb-4 border-b border-gray-600/50" data-v-7d1f5605> Custom Room </h2><p class="text-center text-gray-400 mb-6" data-v-7d1f5605> Create or join a custom game room </p><button disabled class="w-full bg-gray-700 text-gray-500 font-semibold py-3 px-6 rounded-lg cursor-not-allowed" data-v-7d1f5605> Browse Rooms </button></div>',1))])])])]),v(K,{"is-open":l.value,items:B.value,onClose:p},null,8,["is-open","items"])]))}}),bt=D(ct,[["__scopeId","data-v-7d1f5605"]]);export{bt as default};
